#{fixture delete:'all', load:'initial-data.yml' /}

#{selenium 'Create a task'}
	clearSession()
	
	open('/tasks')
	verifyTitle('Login')
	type('username', 'foo@bar.com')
	type('password', 'baz')
	submitAndWait('css=form')
	
	verifyTitle('TODO')
	assertTextPresent('Finish this example')
	
	clickAndWait('link=Create new task')
	type('task.dueTo', '2011-08-21')
	submitAndWait('css=form')
	assertTextPresent('required')

	type('task.title', 'New task')
	type('task.dueTo', '2011-08-21')
	submitAndWait('css=form')
	
	assertTextPresent('Finish this example')
	assertTextPresent('New task')


	clickAndWait('link=Finish this example')
	assertTextPresent('Finish this example')
	assertTextPresent('20/08/2011')
		
	open('/logout')
	assertTextPresent('You have been logged out')
	
	open('/login')
	type('username', 'foo@bar.com')
	type('password', 'wrongpass')
	submitAndWait('css=form')
	assertTextPresent('Oops')
#{/selenium}